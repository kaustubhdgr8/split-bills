{"version":3,"sources":["../src/scripts/app.js"],"names":["activePage","window","location","pathname","db","users","groups","categories","INPUT_ALLOWED_TAGS","ALLOWED_TAGS","_initFirebase","fetchData","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firebase","apps","length","initializeApp","database","index","fetchUsers","Promise","resolve","reject","ref","once","then","snapshot","val","fetchGroups","allSettled","_renderView","_renderUsers","renderUserDetails","document","getElementById","classList","add","_renderGroups","renderGroupDetails","list","Object","entries","user","avatar","name","amount","Math","abs","toFixed","innerHTML","group","type","settled","_totalExpense","_randomNumber","gender","n","floor","random","_todayDate","Date","toLocaleDateString","day","month","year","groupIndex","total","activity","parseFloat","userIndex","details","settleButton","remindButton","memberGroups","number","date","gUserIndex","groupUser","remove","addUser","innerText","setAttribute","value","checked","getElementsByName","radio","editUser","removeUser","alert","confirm","settleDues","update","keys","ctaButtons","_renderGroupUsers","addGroup","editGroup","removeGroup","addGroupUser","multiselect","options","querySelectorAll","forEach","o","Option","removeGroupUser","activateTab","el","contains","clickedTab","getAttribute","_renderGroupActivity","groupRef","userRef","activities","container","content","paidByYou","debtAmount","paidby","split","category","description","addExpense","containerGroup","containerCategories","containerName","containerAmount","containerPaidby","containerUsers","removeAttribute","listGroup","listCategory","listUsers","checkUsers","addEventListener","e","preventDefault","userName","DOMPurify","sanitize","userNumber","userData","infoChanged","key","child","push","newUser","$","modal","groupName","groupType","groupData","newGroup","userOptions","selectedUsers","groupMembers","userGroupObj","i","selected","categoryName","paidbyName","perPersonAmount","checkbox","newActivity","groupUsersUpdate","debt","updatedUserAmount","groupUserObj","selectedUser"],"mappings":"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","sourcesContent":["/**\r\n * GLobal variables\r\n */\r\nlet activePage = window.location.pathname;\r\nlet db, users, groups, categories;\r\nconst INPUT_ALLOWED_TAGS = {\r\n  ALLOWED_TAGS: [],\r\n};\r\n\r\n/**\r\n * initialization\r\n */\r\n_initFirebase();\r\nfetchData();\r\n\r\n/**\r\n * Function declarations\r\n */\r\nfunction _initFirebase() {\r\n  const firebaseConfig = {\r\n    apiKey: \"AIzaSyDFB9Kr3k6rI0T_94lO6hcV3pWU_X-XJ5A\",\r\n    authDomain: \"javascript-293715.firebaseapp.com\",\r\n    databaseURL: \"https://javascript-293715.firebaseio.com\",\r\n    projectId: \"javascript-293715\",\r\n    storageBucket: \"javascript-293715.appspot.com\",\r\n    messagingSenderId: \"711748984217\",\r\n    appId: \"1:711748984217:web:10f6e4e39b074cb0a7c708\",\r\n  };\r\n  if (!firebase.apps.length) {\r\n    firebase.initializeApp(firebaseConfig);\r\n  }\r\n  db = firebase.database();\r\n}\r\nfunction fetchData(index = null) {\r\n  const fetchUsers = new Promise((resolve, reject) => {\r\n    db.ref(\"bill-splitter/users/\")\r\n      .once(\"value\")\r\n      .then((snapshot) => {\r\n        users = snapshot.val();\r\n        resolve();\r\n      });\r\n  });\r\n  const fetchGroups = new Promise((resolve, reject) => {\r\n    db.ref(\"bill-splitter/groups/\")\r\n      .once(\"value\")\r\n      .then((snapshot) => {\r\n        groups = snapshot.val();\r\n        resolve();\r\n      });\r\n  });\r\n\r\n  Promise.allSettled([fetchUsers, fetchGroups]).then(() => {\r\n    _renderView(index);\r\n  });\r\n\r\n  db.ref(\"bill-splitter/categories/\")\r\n    .once(\"value\")\r\n    .then((snapshot) => {\r\n      categories = snapshot.val();\r\n    });\r\n}\r\nfunction _renderView(index = null) {\r\n  if (activePage === \"/users.html\") {\r\n    _renderUsers();\r\n    if (index) {\r\n      renderUserDetails(index);\r\n    } else {\r\n      document\r\n        .getElementById(\"user-details__container\")\r\n        .classList.add(\"hidden\");\r\n    }\r\n  } else if (activePage === \"/groups.html\") {\r\n    _renderGroups();\r\n    if (index) {\r\n      renderGroupDetails(index);\r\n    } else {\r\n      document\r\n        .getElementById(\"group-details__container\")\r\n        .classList.add(\"hidden\");\r\n    }\r\n  }\r\n}\r\nfunction _renderUsers() {\r\n  if (users.length != 0) {\r\n    let list = \"\";\r\n\r\n    for (let [index, user] of Object.entries(users)) {\r\n      list += `<a href=\"#\" class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\" onclick=\"renderUserDetails('${index}')\">\r\n          <span>\r\n            <img src=\"assets/images/${user.avatar}.jpg\" alt=\"${user.avatar}\" class=\"custom__user-list--image\" />\r\n            <span class=\"ml-1 h5\">${user.name}</span>\r\n          </span>`;\r\n      if (user.amount < 0) {\r\n        list += `<span class=\"badge badge-danger custom__user-list--amount\">$${Math.abs(\r\n          user.amount\r\n        ).toFixed(2)}</span> `;\r\n      } else if (user.amount > 0) {\r\n        list += `<span class=\"badge badge-success custom__user-list--amount\">$${user.amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      } else {\r\n        list += `<span class=\"badge badge-secondary custom__user-list--amount\">$${user.amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      }\r\n      list += `</a>`;\r\n    }\r\n    document.getElementById(\"users\").innerHTML = list;\r\n  } else {\r\n    document.getElementById(\r\n      \"users\"\r\n    ).innerHTML = `<div class=\"alert alert-warning\" role=\"alert\">No friends yet! Add friends now and split your bills easily.</div>`;\r\n  }\r\n}\r\nfunction _renderGroups() {\r\n  if (groups.length != 0) {\r\n    let list = \"\";\r\n\r\n    for (let [index, group] of Object.entries(groups)) {\r\n      list += `<a href=\"#\" class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\" onclick=\"renderGroupDetails('${index}')\">\r\n          <span>\r\n            <img src=\"assets/icons/${group.type}.svg\" alt=\"${\r\n        group.type\r\n      } icon\" class=\"custom__group-list--image\" />\r\n            <span class=\"ml-3 h5\">${group.name} </span>\r\n            <span class=\"badge badge-${\r\n              group.settled ? \"secondary\" : \"primary\"\r\n            }\" style=\"font-size: small;\">$${_totalExpense(index).toFixed(\r\n        2\r\n      )}</span>\r\n          </span>\r\n          <small class=\"text-muted\">${\r\n            group.settled ? \"Settled up\" : \"Pending\"\r\n          }</small>\r\n      </a>`;\r\n    }\r\n    document.getElementById(\"groups\").innerHTML = list;\r\n  } else {\r\n    document.getElementById(\r\n      \"groups\"\r\n    ).innerHTML = `<div class=\"alert alert-warning\" role=\"alert\">No groups found! Add a group now and record your expenses.</div>`;\r\n  }\r\n}\r\nfunction _randomNumber(gender) {\r\n  const n = Math.floor(Math.random() * (16 - 1 + 1) + 1);\r\n  if (gender === \"m\") {\r\n    return n % 2 !== 0 ? n : _randomNumber(gender);\r\n  } else if (gender === \"f\") {\r\n    return n % 2 === 0 ? n : _randomNumber(gender);\r\n  } else {\r\n    return n;\r\n  }\r\n}\r\nfunction _todayDate() {\r\n  return new Date().toLocaleDateString(\"en-GB\", {\r\n    day: \"numeric\",\r\n    month: \"short\",\r\n    year: \"numeric\",\r\n  });\r\n}\r\nfunction _totalExpense(groupIndex) {\r\n  let total = 0;\r\n  if (groups[groupIndex].activity) {\r\n    for (let [index, activity] of Object.entries(groups[groupIndex].activity)) {\r\n      total += parseFloat(activity.amount);\r\n    }\r\n  }\r\n  return total;\r\n}\r\n\r\n/**\r\n * User events\r\n */\r\nfunction renderUserDetails(userIndex) {\r\n  const user = users[userIndex];\r\n  let details = `<h3 class=\"card-title\">${user.name}</h3>`;\r\n  let settleButton = `<a href=\"#\" class=\"btn btn-primary\" onclick=\"settleDues('${userIndex}')\">Settle</a>`;\r\n  let remindButton = \"\";\r\n  let memberGroups = \"\";\r\n\r\n  if (user.amount < 0) {\r\n    details += `<p class=\"h4 text-danger\">you owe $${Math.abs(\r\n      user.amount\r\n    ).toFixed(2)}</p>`;\r\n  } else if (user.amount > 0) {\r\n    details += `<p class=\"h4 text-success\">owes you $${user.amount.toFixed(\r\n      2\r\n    )}</p>`;\r\n    if (user.number && user.number != \"\") {\r\n      remindButton = `<a href=\"tel:${user.number}\" class=\"btn btn-outline-success\">Remind</a>`;\r\n    }\r\n  } else {\r\n    details += `<p class=\"h4 text-secondary\">all settled up</p>`;\r\n    settleButton = \"\";\r\n  }\r\n  details += `<p class=\"card-text\">\r\n      <small class=\"text-muted\">Last updated on ${user.date}</small>\r\n    </p>`;\r\n\r\n  for (let [index, group] of Object.entries(groups)) {\r\n    if (group.users) {\r\n      for (let [gUserIndex, groupUser] of Object.entries(group.users)) {\r\n        if (gUserIndex === userIndex) {\r\n          memberGroups += `<li class=\"list-group-item\">\r\n              <a href=\"/groups.html\">\r\n                ${group.name}\r\n              </a>\r\n              <small class=\"text-muted\">(${\r\n                group.settled ? \"settled up\" : \"pending\"\r\n              })</small>\r\n            </li>`;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (memberGroups === \"\") {\r\n    memberGroups = `<div class=\"alert alert-primary\" role=\"alert\">${user.name} does not belong to any group yet.</div>`;\r\n  }\r\n\r\n  document.getElementById(\r\n    \"user-details__image\"\r\n  ).innerHTML = `<img src=\"assets/images/${user.avatar}.jpg\" class=\"card-img\" alt=\"${user.avatar}\"/>`;\r\n  document.getElementById(\"user-details\").innerHTML = details;\r\n  document.getElementById(\"user-details__groups\").innerHTML = memberGroups;\r\n  document.getElementById(\r\n    \"user-details__cta\"\r\n  ).innerHTML = `<div class=\"btn-group btn-group-sm\" role=\"group\">\r\n      ${settleButton}\r\n      ${remindButton}\r\n    </div>\r\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\r\n      <a href=\"#\" class=\"btn btn-outline-primary ml-2\" data-toggle=\"modal\" data-target=\"#form--user\" onclick=\"editUser('${userIndex}')\">Edit profile</a>\r\n      <a href=\"#\" class=\"btn btn-outline-danger\" onclick=\"removeUser('${userIndex}')\">Remove</a>\r\n    </div>`;\r\n  document.getElementById(\"user-details__container\").classList.remove(\"hidden\");\r\n}\r\nfunction addUser() {\r\n  document.getElementById(\"user-form__title\").innerText = \"Add a friend\";\r\n  document.getElementById(\"user-form\").setAttribute(\"data-user\", \"\");\r\n  document.getElementById(\"username\").value = \"\";\r\n  document.getElementById(\"number\").value = \"\";\r\n  document.getElementById(\"consent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    radio.checked = false;\r\n  }\r\n}\r\nfunction editUser(userIndex) {\r\n  const user = users[userIndex];\r\n  document.getElementById(\"user-form__title\").innerText = \"Edit profile\";\r\n  document.getElementById(\"user-form\").setAttribute(\"data-user\", userIndex);\r\n  document.getElementById(\"username\").value = user.name;\r\n  document.getElementById(\"number\").value = user.number;\r\n  document.getElementById(\"consent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    if (radio.value === user.gender) {\r\n      radio.checked = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\nfunction removeUser(userIndex) {\r\n  if (users[userIndex].amount !== 0) {\r\n    alert(\"There are dues outstanding!\\nThe user can't be removed.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/users/${userIndex}`).remove();\r\n    fetchData();\r\n  }\r\n}\r\nfunction settleDues(userIndex) {\r\n  if (confirm(\"Do you want to settle all dues?\")) {\r\n    db.ref(`bill-splitter/users/${userIndex}`).update({\r\n      amount: 0,\r\n      date: _todayDate(),\r\n      settled: true,\r\n    });\r\n    fetchData(userIndex);\r\n  }\r\n}\r\n\r\n/**\r\n * Group events\r\n */\r\nfunction renderGroupDetails(groupIndex) {\r\n  const group = groups[groupIndex];\r\n  document.getElementById(\r\n    \"group-header\"\r\n  ).innerHTML = `<div class=\"d-flex flex-nowrap justify-content-between align-items-center\">\r\n      <h3 class=\"card-title mb-0\">\r\n        ${group.name}\r\n        <small class=\"text-muted\" style=\"font-size: initial;\">(${\r\n          group.settled ? \"settled up\" : \"pending\"\r\n        })</small>\r\n      </h3>\r\n      <div class=\"btn-group btn-group-sm\" role=\"group\">\r\n        <a href=\"#\" class=\"btn btn-outline-primary ml-2\" data-toggle=\"modal\" data-target=\"#form--group\" onclick=\"editGroup('${groupIndex}')\">Edit</a>\r\n        <a href=\"#\" class=\"btn btn-outline-danger\" onclick=\"removeGroup('${groupIndex}')\">Delete</a>\r\n      </div>\r\n    </div>\r\n    <p class=\"card-text\">\r\n      <small class=\"text-muted\">Last updated on ${group.date}</small>\r\n    </p>`;\r\n  document.getElementById(\r\n    \"group-details--tabs\"\r\n  ).innerHTML = `<ul class=\"nav nav-tabs\">\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link active\" href=\"#\" id=\"tab--friend\" onclick=\"activateTab(this, '${groupIndex}')\">\r\n          Friends\r\n          <span class=\"badge badge-${group.settled ? \"secondary\" : \"primary\"}\">\r\n            ${group.users ? Object.keys(group.users).length : 0}\r\n          </span>\r\n        </a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\" id=\"tab--activity\" onclick=\"activateTab(this, '${groupIndex}')\">\r\n          Activity\r\n          <span class=\"badge badge-${group.settled ? \"secondary\" : \"primary\"}\">\r\n            ${group.activity ? Object.keys(group.activity).length : 0}\r\n          </span>\r\n        </a>\r\n      </li>\r\n      <!-- <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\" id=\"tab--chart\" onclick=\"activateTab(this, '${groupIndex}')\">Chart</a>\r\n      </li> -->\r\n    </ul>`;\r\n  document.getElementById(\"group-details\").innerHTML = \"\";\r\n\r\n  let ctaButtons = \"\";\r\n  if (group.users) {\r\n    ctaButtons += `<button class=\"btn btn-primary btn-sm mr-2\" data-toggle=\"modal\" data-target=\"#form--expense\" onclick=\"addExpense('${groupIndex}')\">Record expense</button>`;\r\n  }\r\n  document.getElementById(\"group-details__cta\").innerHTML = `${ctaButtons}\r\n    <button class=\"btn btn-outline-primary btn-sm\" data-toggle=\"modal\" data-target=\"#form--member\" onclick=\"addGroupUser('${groupIndex}')\">Add new member</button>`;\r\n\r\n  document\r\n    .getElementById(\"group-details__container\")\r\n    .classList.remove(\"hidden\");\r\n\r\n  _renderGroupUsers(groupIndex);\r\n}\r\nfunction addGroup() {\r\n  document.getElementById(\"group-form__title\").innerText = \"Create a new group\";\r\n  document.getElementById(\"group-form\").setAttribute(\"data-group\", \"\");\r\n  document.getElementById(\"groupname\").value = \"\";\r\n  document.getElementById(\"groupconsent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    radio.checked = false;\r\n  }\r\n}\r\nfunction editGroup(groupIndex) {\r\n  const group = groups[groupIndex];\r\n  document.getElementById(\"group-form__title\").innerText = \"Edit group details\";\r\n  document.getElementById(\"group-form\").setAttribute(\"data-group\", groupIndex);\r\n  document.getElementById(\"groupname\").value = group.name;\r\n  document.getElementById(\"groupconsent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    if (radio.value === group.type) {\r\n      radio.checked = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\nfunction removeGroup(groupIndex) {\r\n  if (!groups[groupIndex].settled) {\r\n    alert(\"There are dues outstanding!\\nThe group can't be deleted.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/groups/${groupIndex}`).remove();\r\n    fetchData();\r\n  }\r\n}\r\nfunction addGroupUser(groupIndex) {\r\n  document.getElementById(\"member-form\").setAttribute(\"data-group\", groupIndex);\r\n  const multiselect = document.getElementById(\"user-multiselect\");\r\n  const options = document.querySelectorAll(\"#user-multiselect option\");\r\n  options.forEach((o) => o.remove());\r\n\r\n  for (let [index, user] of Object.entries(users)) {\r\n    multiselect.options[multiselect.options.length] = new Option(\r\n      user.name,\r\n      index,\r\n      false\r\n    );\r\n  }\r\n}\r\nfunction removeGroupUser(groupIndex, userIndex) {\r\n  if (groups[groupIndex].users[userIndex] !== 0) {\r\n    alert(\"There are dues outstanding!\\nThe user can't be removed.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/groups/${groupIndex}/users/${userIndex}`).remove();\r\n    fetchData(groupIndex);\r\n  }\r\n}\r\nfunction activateTab(el, groupIndex) {\r\n  if (!el.classList.contains(\"active\")) {\r\n    document.getElementById(\"tab--friend\").classList.remove(\"active\");\r\n    document.getElementById(\"tab--activity\").classList.remove(\"active\");\r\n    //document.getElementById(\"tab--chart\").classList.remove(\"active\");\r\n    document.getElementById(\"group-details\").innerHTML = \"\";\r\n\r\n    el.classList.add(\"active\");\r\n    const clickedTab = el.getAttribute(\"id\");\r\n\r\n    if (clickedTab === \"tab--friend\") {\r\n      _renderGroupUsers(groupIndex);\r\n    } else if (clickedTab === \"tab--activity\") {\r\n      _renderGroupActivity(groupIndex);\r\n    } else {\r\n      // _renderGroupChart(groupIndex);\r\n    }\r\n  }\r\n}\r\nfunction _renderGroupUsers(groupIndex) {\r\n  const groupRef = groups[groupIndex];\r\n  let list = `<ul class=\"list-group list-group-flush mt-2\">`;\r\n\r\n  if (groupRef.users && Object.keys(groupRef.users).length !== 0) {\r\n    let userRef;\r\n\r\n    for (let [index, amount] of Object.entries(groupRef.users)) {\r\n      userRef = users[index];\r\n      list += `<li class=\"list-group-item\">\r\n          <div class=\"d-flex justify-content-between align-items-center\">\r\n            <span class=\"d-flex justify-content-start align-items-center\">  \r\n              <img src=\"assets/images/${userRef.avatar}.jpg\" alt=\"${userRef.avatar}\" class=\"custom__group-user-list--image\" />\r\n              <span class=\"ml-1\">${userRef.name}</span>\r\n            </span>\r\n            <div style=\"text-align: right;\">`;\r\n      if (amount < 0) {\r\n        list += `<span class=\"text-danger mr-2\"><small class=\"text-muted\">you owe</small> $${Math.abs(\r\n          amount\r\n        ).toFixed(2)}</span>`;\r\n      } else if (amount > 0) {\r\n        list += `<span class=\"text-success mr-2\"><small class=\"text-muted\">owes you</small> $${amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      } else {\r\n        list += `<small class=\"text-muted mr-2\">all settled up</small>`;\r\n      }\r\n      if (amount != 0) {\r\n        list += `<button type=\"button\" class=\"btn btn-outline-primary btn-sm\">Settle</button>`;\r\n      } else {\r\n        list += `<button type=\"button\" class=\"btn btn-outline-danger btn-sm\" onclick=\"removeGroupUser('${groupIndex}', '${index}')\">Remove</button>`;\r\n      }\r\n      list += `</div>\r\n        </li>`;\r\n    }\r\n    list += `</ul>`;\r\n  } else {\r\n    list = `<div class=\"alert alert-warning mt-3\" role=\"alert\">No friends yet! Add friends to start recording your expenses.</div>`;\r\n  }\r\n\r\n  document.getElementById(\"group-details\").innerHTML = list;\r\n}\r\nfunction _renderGroupActivity(groupIndex) {\r\n  const activities = groups[groupIndex].activity;\r\n  const container = document.getElementById(\"group-details\");\r\n\r\n  if (!activities || Object.keys(activities).length === 0) {\r\n    container.innerHTML = `<div class=\"alert alert-warning mt-3\" role=\"alert\">No bills added yet! Record your expenses now and split your bills easily.</div>`;\r\n  } else {\r\n    let content = `<ul class=\"list-group list-group-flush mt-2\">`;\r\n    let paidByYou, debtAmount;\r\n\r\n    for (let [index, activity] of Object.entries(activities)) {\r\n      paidByYou = activity.paidby === \"0\";\r\n      if (paidByYou) {\r\n        debtAmount =\r\n          parseFloat(activity.amount) -\r\n          parseFloat(activity.amount) / Object.keys(activity.split).length;\r\n      } else {\r\n        debtAmount =\r\n          parseFloat(activity.amount) / Object.keys(activity.split).length;\r\n      }\r\n      content += `<li class=\"list-group-item\">\r\n          <div class=\"d-flex justify-content-between align-items-center mb-2\"> \r\n            <div class=\"d-flex justify-content-start align-items-baseline\">\r\n              <img \r\n                src=\"assets/icons/${activity.category}.svg\"\r\n                alt=\"${activity.category} icon\"\r\n                class=\"custom__group-category--image\">\r\n              <span class=\"ml-2 h5\">\r\n                ${activity.description}\r\n                <small class=\"text-muted\">(${\r\n                  categories[activity.category]\r\n                })</small>\r\n              </span>\r\n            </div>\r\n            <div class=\"h5 text-${\r\n              paidByYou ? \"success\" : \"danger\"\r\n            }\" style=\"text-align: right;\">\r\n              <small style=\"font-size: small;\">${\r\n                paidByYou ? \"you lent\" : \"you borrowed\"\r\n              }</small>\r\n              $${debtAmount.toFixed(2)}\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex justify-content-between align-items-start\">\r\n            <span class=\"d-flex flex-column align-items-start\">\r\n              <span>Total: $${activity.amount}</span>\r\n              <small class=\"text-muted\">\r\n                (Paid by ${\r\n                  paidByYou ? \"You\" : users[activity.paidby].name\r\n                })</small>\r\n            </span>\r\n            <span class=\"d-flex flex-column align-items-end\">`;\r\n\r\n      for (let [userIndex, user] of Object.entries(activity.split)) {\r\n        if (userIndex !== \"0\") {\r\n          content += `<small>${users[userIndex].name}</small>`;\r\n        }\r\n      }\r\n\r\n      content += `</span>\r\n          </div>\r\n        </li>`;\r\n    }\r\n    container.innerHTML = content;\r\n  }\r\n}\r\n\r\n/**\r\n * Expense events\r\n */\r\nfunction addExpense(groupIndex = null) {\r\n  const containerGroup = document.getElementById(\"expense-group\");\r\n  const containerCategories = document.getElementById(\"expense-category\");\r\n  const containerName = document.getElementById(\"expense-name\");\r\n  const containerAmount = document.getElementById(\"expense-amount\");\r\n  const containerPaidby = document.getElementById(\"expense-paidby\");\r\n  const containerUsers = document.getElementById(\"expense-user-list\");\r\n\r\n  containerGroup.innerHTML = \"\";\r\n  containerGroup.removeAttribute(\"disabled\");\r\n  containerCategories.innerHTML = \"\";\r\n  containerName.value = \"\";\r\n  containerAmount.value = \"\";\r\n  containerPaidby.innerHTML = \"\";\r\n  containerUsers.innerHTML = \"\";\r\n\r\n  let listGroup = \"\";\r\n  let listCategory = \"\";\r\n  let listUsers = `<option value=\"0\">You</option>`;\r\n  let checkUsers = \"\";\r\n\r\n  if (groupIndex) {\r\n    listGroup = `<option value=\"${groupIndex}\" selected>${groups[groupIndex].name}</option>`;\r\n    containerGroup.setAttribute(\"disabled\", \"disabled\");\r\n    for (let [index, user] of Object.entries(groups[groupIndex].users)) {\r\n      listUsers += `<option value=\"${index}\">${users[index].name}</option>`;\r\n      checkUsers += `<div class=\"form-check\">\r\n        <input\r\n          class=\"form-check-input\"\r\n          type=\"checkbox\"\r\n          name=\"expense-users\"\r\n          id=\"${index}\"\r\n          value=\"${index}\"\r\n        />\r\n        <label class=\"form-check-label\" for=\"${index}\">${users[index].name}</label>\r\n      </div>`;\r\n    }\r\n  } else {\r\n    for (let [index, group] of Object.entries(groups)) {\r\n      listGroup += `<option value=\"${index}\">${group.name}</option>`;\r\n    }\r\n    for (let [index, user] of Object.entries(users)) {\r\n      listUsers += `<option value=\"${index}\">${user.name}</option>`;\r\n      checkUsers += `<div class=\"form-check\">\r\n        <input\r\n          class=\"form-check-input\"\r\n          type=\"checkbox\"\r\n          name=\"expense-users\"\r\n          id=\"${index}\"\r\n          value=\"${index}\"\r\n        />\r\n        <label class=\"form-check-label\" for=\"${index}\">${user.name}</label>\r\n      </div>`;\r\n    }\r\n  }\r\n  for (let [index, category] of Object.entries(categories)) {\r\n    listCategory += `<option value=\"${index}\">${category}</option>`;\r\n  }\r\n\r\n  containerGroup.innerHTML = listGroup;\r\n  containerCategories.innerHTML = listCategory;\r\n  containerPaidby.innerHTML = listUsers;\r\n  containerUsers.innerHTML = checkUsers;\r\n  document\r\n    .getElementById(\"expense-form\")\r\n    .setAttribute(\"data-group\", groupIndex ? groupIndex : \"\");\r\n}\r\n\r\n/**\r\n * Event listener bindings\r\n */\r\ndocument.getElementById(\"user-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const userIndex = document\r\n    .getElementById(\"user-form\")\r\n    .getAttribute(\"data-user\");\r\n  const userName = DOMPurify.sanitize(\r\n    document.getElementById(\"username\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const userNumber = DOMPurify.sanitize(\r\n    document.getElementById(\"number\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  let gender;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    if (radio.checked) {\r\n      gender = radio.value;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (userIndex !== \"\") {\r\n    const user = users[userIndex];\r\n    let userData = {};\r\n    let infoChanged = false;\r\n\r\n    if (userName !== user.name) {\r\n      userData.name = userName;\r\n      infoChanged = true;\r\n    }\r\n    if (userNumber !== user.number) {\r\n      userData.number = userNumber;\r\n      infoChanged = true;\r\n    }\r\n    if (gender !== user.gender) {\r\n      userData.gender = gender;\r\n      userData.avatar = \"avatar-\" + _randomNumber(gender);\r\n      infoChanged = true;\r\n    }\r\n\r\n    if (infoChanged) {\r\n      userData.date = _todayDate();\r\n      db.ref(`bill-splitter/users/${userIndex}`).update(userData);\r\n      fetchData(userIndex);\r\n    }\r\n  } else {\r\n    const key = db.ref().child(\"bill-splitter\").push().key;\r\n    let newUser = {};\r\n\r\n    newUser[`bill-splitter/users/${key}`] = {\r\n      name: userName,\r\n      number: userNumber,\r\n      gender: gender,\r\n      amount: 0,\r\n      avatar: \"avatar-\" + _randomNumber(gender),\r\n      date: _todayDate(),\r\n      settled: true,\r\n    };\r\n    db.ref().update(newUser);\r\n    fetchData();\r\n  }\r\n  $(\"#form--user\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"group-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const groupIndex = document\r\n    .getElementById(\"group-form\")\r\n    .getAttribute(\"data-group\");\r\n  const groupName = DOMPurify.sanitize(\r\n    document.getElementById(\"groupname\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  let groupType;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    if (radio.checked) {\r\n      groupType = radio.value;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (groupIndex !== \"\") {\r\n    const group = groups[groupIndex];\r\n    let groupData = {};\r\n    let infoChanged = false;\r\n\r\n    if (groupName !== group.name) {\r\n      groupData.name = groupName;\r\n      infoChanged = true;\r\n    }\r\n    if (groupType !== group.type) {\r\n      groupData.type = groupType;\r\n      infoChanged = true;\r\n    }\r\n\r\n    if (infoChanged) {\r\n      groupData.date = _todayDate();\r\n      db.ref(`bill-splitter/groups/${groupIndex}`).update(groupData);\r\n      fetchData(groupIndex);\r\n    }\r\n  } else {\r\n    const key = db.ref().child(\"bill-splitter\").push().key;\r\n    let newGroup = {};\r\n\r\n    newGroup[`bill-splitter/groups/${key}`] = {\r\n      name: groupName,\r\n      type: groupType,\r\n      date: _todayDate(),\r\n      settled: true,\r\n    };\r\n    db.ref().update(newGroup);\r\n    fetchData(key);\r\n  }\r\n  $(\"#form--group\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"member-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const groupIndex = document\r\n    .getElementById(\"member-form\")\r\n    .getAttribute(\"data-group\");\r\n  const multiselect = document.getElementById(\"user-multiselect\");\r\n  const userOptions = multiselect && multiselect.options;\r\n  let selectedUsers = [];\r\n  let groupMembers = {};\r\n  let userGroupObj;\r\n\r\n  for (let i = 0; i < userOptions.length; i++) {\r\n    if (userOptions[i].selected) {\r\n      selectedUsers.push(userOptions[i].value);\r\n    }\r\n  }\r\n  selectedUsers.forEach((user) => {\r\n    userGroupObj = {};\r\n    if (!groups[groupIndex].users || !groups[groupIndex].users[user]) {\r\n      groupMembers[user] = 0;\r\n    }\r\n    userGroupObj[groupIndex] = true;\r\n    db.ref(`bill-splitter/users/${user}/groups`).update(userGroupObj);\r\n    db.ref(`bill-splitter/users/${user}`).update({\r\n      date: _todayDate(),\r\n    });\r\n  });\r\n\r\n  db.ref(`bill-splitter/groups/${groupIndex}/users`).update(groupMembers);\r\n  db.ref(`bill-splitter/groups/${groupIndex}`).update({\r\n    date: _todayDate(),\r\n  });\r\n\r\n  fetchData(groupIndex);\r\n  $(\"#form--member\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"expense-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n\r\n  const groupIndex = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-group\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const categoryName = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-category\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const description = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-name\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const amount = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-amount\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const paidbyName = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-paidby\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n\r\n  let selectedUsers = {};\r\n  let perPersonAmount;\r\n\r\n  for (const checkbox of document.getElementsByName(\"expense-users\")) {\r\n    if (checkbox.checked) {\r\n      selectedUsers[checkbox.value] = true;\r\n    }\r\n  }\r\n  selectedUsers[paidbyName] = true;\r\n  if (paidbyName !== \"0\") {\r\n    selectedUsers[\"0\"] = true;\r\n  }\r\n\r\n  perPersonAmount = parseFloat(amount) / Object.keys(selectedUsers).length;\r\n\r\n  const key = db.ref().child(\"bill-splitter\").push().key;\r\n  let newActivity = {};\r\n\r\n  newActivity[`bill-splitter/groups/${groupIndex}/activity/${key}`] = {\r\n    category: categoryName,\r\n    description: description,\r\n    amount: amount,\r\n    paidby: paidbyName,\r\n    split: selectedUsers,\r\n    date: _todayDate(),\r\n  };\r\n\r\n  db.ref().update(newActivity);\r\n  db.ref(`bill-splitter/groups/${groupIndex}`).update({\r\n    date: _todayDate(),\r\n    settled: false,\r\n  });\r\n\r\n  let groupUsersUpdate = {};\r\n  let debt, updatedUserAmount, groupUserObj;\r\n\r\n  if (paidbyName === \"0\") {\r\n    for (let [userIndex, selectedUser] of Object.entries(selectedUsers)) {\r\n      if (userIndex !== \"0\") {\r\n        groupUserObj = groups[groupIndex].users[userIndex];\r\n        debt = groupUserObj ? groupUserObj + perPersonAmount : perPersonAmount;\r\n\r\n        groupUsersUpdate[userIndex] = debt;\r\n        updatedUserAmount = users[userIndex].amount + debt;\r\n\r\n        db.ref(`bill-splitter/users/${userIndex}`).update({\r\n          amount: updatedUserAmount,\r\n          settled: false,\r\n        });\r\n      }\r\n    }\r\n  } else {\r\n    groupUserObj = groups[groupIndex].users[paidbyName];\r\n    debt = groupUserObj ? groupUserObj - perPersonAmount : 0 - perPersonAmount;\r\n\r\n    groupUsersUpdate[paidbyName] = debt;\r\n    updatedUserAmount = users[paidbyName].amount - perPersonAmount;\r\n\r\n    db.ref(`bill-splitter/users/${paidbyName}`).update({\r\n      amount: updatedUserAmount,\r\n      settled: false,\r\n    });\r\n  }\r\n\r\n  db.ref(`bill-splitter/groups/${groupIndex}/users`).update(groupUsersUpdate);\r\n  fetchData(groupIndex);\r\n  $(\"#form--expense\").modal(\"toggle\");\r\n});\r\n"],"file":"app.js"}