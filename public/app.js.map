{"version":3,"sources":["../src/scripts/app.js"],"names":["activePage","window","location","pathname","db","users","groups","categories","INPUT_ALLOWED_TAGS","ALLOWED_TAGS","_initFirebase","fetchData","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firebase","apps","length","initializeApp","database","index","fetchUsers","Promise","resolve","reject","ref","once","then","snapshot","val","fetchGroups","allSettled","_renderView","_renderUsers","renderUserDetails","document","getElementById","classList","add","_renderGroups","renderGroupDetails","_renderDashboard","list","Object","entries","user","avatar","name","amount","Math","abs","toFixed","innerHTML","_renderDuesAlert","group","type","settled","_totalExpense","title","usersContainer","groupsContainer","_calculateTotal","usersList","groupsList","_randomNumber","gender","n","floor","random","_todayDate","Date","toLocaleDateString","day","month","year","groupIndex","total","activity","parseFloat","container","userIndex","details","settleButton","remindButton","memberGroups","number","date","gUserIndex","groupUser","remove","addUser","innerText","setAttribute","value","checked","getElementsByName","radio","editUser","removeUser","alert","confirm","settleDues","update","keys","ctaButtons","_renderGroupUsers","addGroup","editGroup","removeGroup","addGroupUser","multiselect","options","querySelectorAll","forEach","o","Option","removeGroupUser","activateTab","el","contains","clickedTab","getAttribute","_renderGroupActivity","groupRef","userRef","activities","content","paidByYou","debtAmount","paidby","split","category","description","addExpense","containerGroup","containerCategories","containerName","containerAmount","containerPaidby","containerUsers","removeAttribute","listGroup","listCategory","listUsers","checkUsers","addEventListener","e","preventDefault","userName","DOMPurify","sanitize","userNumber","userData","infoChanged","key","child","push","newUser","$","modal","groupName","groupType","groupData","newGroup","userOptions","selectedUsers","groupMembers","userGroupObj","i","selected","categoryName","paidbyName","perPersonAmount","checkbox","newActivity","groupUsersUpdate","debt","updatedUserAmount","groupUserObj","selectedUser"],"mappings":"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","sourcesContent":["/**\r\n * GLobal variables\r\n */\r\nlet activePage = window.location.pathname;\r\nlet db, users, groups, categories;\r\nconst INPUT_ALLOWED_TAGS = {\r\n  ALLOWED_TAGS: [],\r\n};\r\n\r\n/**\r\n * initialization\r\n */\r\n_initFirebase();\r\nfetchData();\r\n\r\n/**\r\n * Function declarations\r\n */\r\nfunction _initFirebase() {\r\n  const firebaseConfig = {\r\n    apiKey: \"AIzaSyDFB9Kr3k6rI0T_94lO6hcV3pWU_X-XJ5A\",\r\n    authDomain: \"javascript-293715.firebaseapp.com\",\r\n    databaseURL: \"https://javascript-293715.firebaseio.com\",\r\n    projectId: \"javascript-293715\",\r\n    storageBucket: \"javascript-293715.appspot.com\",\r\n    messagingSenderId: \"711748984217\",\r\n    appId: \"1:711748984217:web:10f6e4e39b074cb0a7c708\",\r\n  };\r\n  if (!firebase.apps.length) {\r\n    firebase.initializeApp(firebaseConfig);\r\n  }\r\n  db = firebase.database();\r\n}\r\nfunction fetchData(index = null) {\r\n  const fetchUsers = new Promise((resolve, reject) => {\r\n    db.ref(\"bill-splitter/users/\")\r\n      .once(\"value\")\r\n      .then((snapshot) => {\r\n        users = snapshot.val();\r\n        resolve();\r\n      });\r\n  });\r\n  const fetchGroups = new Promise((resolve, reject) => {\r\n    db.ref(\"bill-splitter/groups/\")\r\n      .once(\"value\")\r\n      .then((snapshot) => {\r\n        groups = snapshot.val();\r\n        resolve();\r\n      });\r\n  });\r\n\r\n  Promise.allSettled([fetchUsers, fetchGroups]).then(() => {\r\n    _renderView(index);\r\n  });\r\n\r\n  db.ref(\"bill-splitter/categories/\")\r\n    .once(\"value\")\r\n    .then((snapshot) => {\r\n      categories = snapshot.val();\r\n    });\r\n}\r\nfunction _renderView(index = null) {\r\n  if (activePage === \"/users.html\") {\r\n    _renderUsers();\r\n    if (index) {\r\n      renderUserDetails(index);\r\n    } else {\r\n      document\r\n        .getElementById(\"user-details__container\")\r\n        .classList.add(\"hidden\");\r\n    }\r\n  } else if (activePage === \"/groups.html\") {\r\n    _renderGroups();\r\n    if (index) {\r\n      renderGroupDetails(index);\r\n    } else {\r\n      document\r\n        .getElementById(\"group-details__container\")\r\n        .classList.add(\"hidden\");\r\n    }\r\n  } else {\r\n    _renderDashboard();\r\n  }\r\n}\r\nfunction _renderUsers() {\r\n  if (users.length != 0) {\r\n    let list = \"\";\r\n\r\n    for (let [index, user] of Object.entries(users)) {\r\n      list += `<a href=\"#\" class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\" onclick=\"renderUserDetails('${index}')\">\r\n          <span>\r\n            <img src=\"assets/images/${user.avatar}.jpg\" alt=\"${user.avatar}\" class=\"custom__user-list--image\" />\r\n            <span class=\"ml-1 h5\">${user.name}</span>\r\n          </span>`;\r\n      if (user.amount < 0) {\r\n        list += `<span class=\"badge badge-danger custom__user-list--amount\">$${Math.abs(\r\n          user.amount\r\n        ).toFixed(2)}</span> `;\r\n      } else if (user.amount > 0) {\r\n        list += `<span class=\"badge badge-success custom__user-list--amount\">$${user.amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      } else {\r\n        list += `<span class=\"badge badge-secondary custom__user-list--amount\">$${user.amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      }\r\n      list += `</a>`;\r\n    }\r\n    document.getElementById(\"users\").innerHTML = list;\r\n  } else {\r\n    document.getElementById(\r\n      \"users\"\r\n    ).innerHTML = `<div class=\"alert alert-warning\" role=\"alert\">No friends yet! Add friends now and split your bills easily.</div>`;\r\n  }\r\n  _renderDuesAlert();\r\n}\r\nfunction _renderGroups() {\r\n  if (groups.length != 0) {\r\n    let list = \"\";\r\n\r\n    for (let [index, group] of Object.entries(groups)) {\r\n      list += `<a href=\"#\" class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\" onclick=\"renderGroupDetails('${index}')\">\r\n          <span>\r\n            <img src=\"assets/icons/${group.type}.svg\" alt=\"${\r\n        group.type\r\n      } icon\" class=\"custom__group-list--image\" />\r\n            <span class=\"ml-3 h5\">${group.name} </span>\r\n            <span class=\"badge badge-${\r\n              group.settled ? \"secondary\" : \"primary\"\r\n            }\" style=\"font-size: small;\">$${_totalExpense(index).toFixed(\r\n        2\r\n      )}</span>\r\n          </span>\r\n          <small class=\"text-muted\">${\r\n            group.settled ? \"Settled up\" : \"Pending\"\r\n          }</small>\r\n      </a>`;\r\n    }\r\n    document.getElementById(\"groups\").innerHTML = list;\r\n  } else {\r\n    document.getElementById(\r\n      \"groups\"\r\n    ).innerHTML = `<div class=\"alert alert-warning\" role=\"alert\">No groups found! Add a group now and record your expenses.</div>`;\r\n  }\r\n  _renderDuesAlert();\r\n}\r\nfunction _renderDashboard() {\r\n  const title = document.getElementById(\"dashboard__title\");\r\n  const usersContainer = document.getElementById(\"dashboard__list--users\");\r\n  const groupsContainer = document.getElementById(\"dashboard__list--groups\");\r\n  const amount = _calculateTotal();\r\n\r\n  let usersList = `<ul class=\"list-group list-group-flush\">`;\r\n  let groupsList = `<ul class=\"list-group list-group-flush\">`;\r\n\r\n  if (amount < 0) {\r\n    title.innerHTML = `You owe your friend(s) <span class=\"display-4\">$${Math.abs(\r\n      amount.toFixed(2)\r\n    )}!</span>`;\r\n    title.classList.add(\"text-danger\");\r\n  } else if (amount > 0) {\r\n    title.innerHTML = `Your friend(s) owe you <span class=\"display-4\">$${amount.toFixed(\r\n      2\r\n    )}!</span>`;\r\n    title.classList.add(\"text-success\");\r\n  } else {\r\n    title.innerHTML = \"Everything is settled up!\";\r\n  }\r\n\r\n  for (let [index, user] of Object.entries(users)) {\r\n    if (!user.settled) {\r\n      usersList += `\r\n        <li class=\"list-group-item d-flex justify-content-between\">\r\n          <span>${user.name}</span>\r\n          <span class=\"${\r\n            user.amount < 0 ? \"text-danger\" : \"text-success\"\r\n          }\">$${Math.abs(user.amount.toFixed(2))}</span>\r\n        </li>\r\n      `;\r\n    }\r\n  }\r\n  usersList += \"<ul>\";\r\n\r\n  for (let [index, group] of Object.entries(groups)) {\r\n    if (!group.settled) {\r\n      groupsList += `<li class=\"list-group-item\"><a href=\"/groups.html\">${group.name}</a></li>`;\r\n    }\r\n  }\r\n  groupsList += \"<ul>\";\r\n\r\n  usersContainer.innerHTML = usersList;\r\n  groupsContainer.innerHTML = groupsList;\r\n}\r\nfunction _randomNumber(gender) {\r\n  const n = Math.floor(Math.random() * (16 - 1 + 1) + 1);\r\n  if (gender === \"m\") {\r\n    return n % 2 !== 0 ? n : _randomNumber(gender);\r\n  } else if (gender === \"f\") {\r\n    return n % 2 === 0 ? n : _randomNumber(gender);\r\n  } else {\r\n    return n;\r\n  }\r\n}\r\nfunction _todayDate() {\r\n  return new Date().toLocaleDateString(\"en-GB\", {\r\n    day: \"numeric\",\r\n    month: \"short\",\r\n    year: \"numeric\",\r\n  });\r\n}\r\nfunction _totalExpense(groupIndex) {\r\n  let total = 0;\r\n  if (groups[groupIndex].activity) {\r\n    for (let [index, activity] of Object.entries(groups[groupIndex].activity)) {\r\n      total += parseFloat(activity.amount);\r\n    }\r\n  }\r\n  return total;\r\n}\r\nfunction _calculateTotal() {\r\n  let amount = 0;\r\n  if (users.length !== 0) {\r\n    for (let [index, user] of Object.entries(users)) {\r\n      if (!user.settled) {\r\n        amount += user.amount;\r\n      }\r\n    }\r\n  }\r\n  return amount;\r\n}\r\nfunction _renderDuesAlert() {\r\n  const container = document.getElementById(\"totalDuesAlert\");\r\n  const amount = _calculateTotal();\r\n\r\n  if (amount < 0) {\r\n    container.innerHTML = `You have to pay <span class=\"h5\">$${Math.abs(\r\n      amount.toFixed(2)\r\n    )}</span>. This amount is the total of all the dues for all the pending (non-settled) groups.`;\r\n    container.classList.add(\"alert-danger\");\r\n  } else if (amount > 0) {\r\n    container.innerHTML = `You are owed <span class=\"h5\">$${amount.toFixed(\r\n      2\r\n    )}</span>. This amount is the total of all the dues for all the pending (non-settled) groups.`;\r\n    container.classList.add(\"alert-success\");\r\n  } else {\r\n    container.innerHTML = \"Everything is settled up!\";\r\n    container.classList.add(\"alert-secondary\");\r\n  }\r\n}\r\n\r\n/**\r\n * User events\r\n */\r\nfunction renderUserDetails(userIndex) {\r\n  const user = users[userIndex];\r\n  let details = `<h3 class=\"card-title\">${user.name}</h3>`;\r\n  let settleButton = `<a href=\"#\" class=\"btn btn-primary\" onclick=\"settleDues('${userIndex}')\">Settle</a>`;\r\n  let remindButton = \"\";\r\n  let memberGroups = \"\";\r\n\r\n  if (user.amount < 0) {\r\n    details += `<p class=\"h4 text-danger\">you owe $${Math.abs(\r\n      user.amount\r\n    ).toFixed(2)}</p>`;\r\n  } else if (user.amount > 0) {\r\n    details += `<p class=\"h4 text-success\">owes you $${user.amount.toFixed(\r\n      2\r\n    )}</p>`;\r\n    if (user.number && user.number != \"\") {\r\n      remindButton = `<a href=\"tel:${user.number}\" class=\"btn btn-outline-success\">Remind</a>`;\r\n    }\r\n  } else {\r\n    details += `<p class=\"h4 text-secondary\">all settled up</p>`;\r\n    settleButton = \"\";\r\n  }\r\n  details += `<p class=\"card-text\">\r\n      <small class=\"text-muted\">Last updated on ${user.date}</small>\r\n    </p>`;\r\n\r\n  for (let [index, group] of Object.entries(groups)) {\r\n    if (group.users) {\r\n      for (let [gUserIndex, groupUser] of Object.entries(group.users)) {\r\n        if (gUserIndex === userIndex) {\r\n          memberGroups += `<li class=\"list-group-item\">\r\n              <a href=\"/groups.html\">\r\n                ${group.name}\r\n              </a>\r\n              <small class=\"text-muted\">(${\r\n                group.settled ? \"settled up\" : \"pending\"\r\n              })</small>\r\n            </li>`;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (memberGroups === \"\") {\r\n    memberGroups = `<div class=\"alert alert-primary\" role=\"alert\">${user.name} does not belong to any group yet.</div>`;\r\n  }\r\n\r\n  document.getElementById(\r\n    \"user-details__image\"\r\n  ).innerHTML = `<img src=\"assets/images/${user.avatar}.jpg\" class=\"card-img\" alt=\"${user.avatar}\"/>`;\r\n  document.getElementById(\"user-details\").innerHTML = details;\r\n  document.getElementById(\"user-details__groups\").innerHTML = memberGroups;\r\n  document.getElementById(\r\n    \"user-details__cta\"\r\n  ).innerHTML = `<div class=\"btn-group btn-group-sm\" role=\"group\">\r\n      ${settleButton}\r\n      ${remindButton}\r\n    </div>\r\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\r\n      <a href=\"#\" class=\"btn btn-outline-primary ml-2\" data-toggle=\"modal\" data-target=\"#form--user\" onclick=\"editUser('${userIndex}')\">Edit profile</a>\r\n      <a href=\"#\" class=\"btn btn-outline-danger\" onclick=\"removeUser('${userIndex}')\">Remove</a>\r\n    </div>`;\r\n  document.getElementById(\"user-details__container\").classList.remove(\"hidden\");\r\n}\r\nfunction addUser() {\r\n  document.getElementById(\"user-form__title\").innerText = \"Add a friend\";\r\n  document.getElementById(\"user-form\").setAttribute(\"data-user\", \"\");\r\n  document.getElementById(\"username\").value = \"\";\r\n  document.getElementById(\"number\").value = \"\";\r\n  document.getElementById(\"consent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    radio.checked = false;\r\n  }\r\n}\r\nfunction editUser(userIndex) {\r\n  const user = users[userIndex];\r\n  document.getElementById(\"user-form__title\").innerText = \"Edit profile\";\r\n  document.getElementById(\"user-form\").setAttribute(\"data-user\", userIndex);\r\n  document.getElementById(\"username\").value = user.name;\r\n  document.getElementById(\"number\").value = user.number;\r\n  document.getElementById(\"consent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    if (radio.value === user.gender) {\r\n      radio.checked = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\nfunction removeUser(userIndex) {\r\n  if (users[userIndex].amount !== 0) {\r\n    alert(\"There are dues outstanding!\\nThe user can't be removed.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/users/${userIndex}`).remove();\r\n    fetchData();\r\n  }\r\n}\r\nfunction settleDues(userIndex) {\r\n  if (confirm(\"Do you want to settle all dues?\")) {\r\n    db.ref(`bill-splitter/users/${userIndex}`).update({\r\n      amount: 0,\r\n      date: _todayDate(),\r\n      settled: true,\r\n    });\r\n    fetchData(userIndex);\r\n  }\r\n}\r\n\r\n/**\r\n * Group events\r\n */\r\nfunction renderGroupDetails(groupIndex) {\r\n  const group = groups[groupIndex];\r\n  document.getElementById(\r\n    \"group-header\"\r\n  ).innerHTML = `<div class=\"d-flex flex-nowrap justify-content-between align-items-center\">\r\n      <h3 class=\"card-title mb-0\">\r\n        ${group.name}\r\n        <small class=\"text-muted\" style=\"font-size: initial;\">(${\r\n          group.settled ? \"settled up\" : \"pending\"\r\n        })</small>\r\n      </h3>\r\n      <div class=\"btn-group btn-group-sm\" role=\"group\">\r\n        <a href=\"#\" class=\"btn btn-outline-primary ml-2\" data-toggle=\"modal\" data-target=\"#form--group\" onclick=\"editGroup('${groupIndex}')\">Edit</a>\r\n        <a href=\"#\" class=\"btn btn-outline-danger\" onclick=\"removeGroup('${groupIndex}')\">Delete</a>\r\n      </div>\r\n    </div>\r\n    <p class=\"card-text\">\r\n      <small class=\"text-muted\">Last updated on ${group.date}</small>\r\n    </p>`;\r\n  document.getElementById(\r\n    \"group-details--tabs\"\r\n  ).innerHTML = `<ul class=\"nav nav-tabs\">\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link active\" href=\"#\" id=\"tab--friend\" onclick=\"activateTab(this, '${groupIndex}')\">\r\n          Friends\r\n          <span class=\"badge badge-${group.settled ? \"secondary\" : \"primary\"}\">\r\n            ${group.users ? Object.keys(group.users).length : 0}\r\n          </span>\r\n        </a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\" id=\"tab--activity\" onclick=\"activateTab(this, '${groupIndex}')\">\r\n          Activity\r\n          <span class=\"badge badge-${group.settled ? \"secondary\" : \"primary\"}\">\r\n            ${group.activity ? Object.keys(group.activity).length : 0}\r\n          </span>\r\n        </a>\r\n      </li>\r\n      <!-- <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\" id=\"tab--chart\" onclick=\"activateTab(this, '${groupIndex}')\">Chart</a>\r\n      </li> -->\r\n    </ul>`;\r\n  document.getElementById(\"group-details\").innerHTML = \"\";\r\n\r\n  let ctaButtons = \"\";\r\n  if (group.users) {\r\n    ctaButtons += `<button class=\"btn btn-primary btn-sm mr-2\" data-toggle=\"modal\" data-target=\"#form--expense\" onclick=\"addExpense('${groupIndex}')\">Record expense</button>`;\r\n  }\r\n  document.getElementById(\"group-details__cta\").innerHTML = `${ctaButtons}\r\n    <button class=\"btn btn-outline-primary btn-sm\" data-toggle=\"modal\" data-target=\"#form--member\" onclick=\"addGroupUser('${groupIndex}')\">Add new member</button>`;\r\n\r\n  document\r\n    .getElementById(\"group-details__container\")\r\n    .classList.remove(\"hidden\");\r\n\r\n  _renderGroupUsers(groupIndex);\r\n}\r\nfunction addGroup() {\r\n  document.getElementById(\"group-form__title\").innerText = \"Create a new group\";\r\n  document.getElementById(\"group-form\").setAttribute(\"data-group\", \"\");\r\n  document.getElementById(\"groupname\").value = \"\";\r\n  document.getElementById(\"groupconsent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    radio.checked = false;\r\n  }\r\n}\r\nfunction editGroup(groupIndex) {\r\n  const group = groups[groupIndex];\r\n  document.getElementById(\"group-form__title\").innerText = \"Edit group details\";\r\n  document.getElementById(\"group-form\").setAttribute(\"data-group\", groupIndex);\r\n  document.getElementById(\"groupname\").value = group.name;\r\n  document.getElementById(\"groupconsent\").checked = false;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    if (radio.value === group.type) {\r\n      radio.checked = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\nfunction removeGroup(groupIndex) {\r\n  if (!groups[groupIndex].settled) {\r\n    alert(\"There are dues outstanding!\\nThe group can't be deleted.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/groups/${groupIndex}`).remove();\r\n    fetchData();\r\n  }\r\n}\r\nfunction addGroupUser(groupIndex) {\r\n  document.getElementById(\"member-form\").setAttribute(\"data-group\", groupIndex);\r\n  const multiselect = document.getElementById(\"user-multiselect\");\r\n  const options = document.querySelectorAll(\"#user-multiselect option\");\r\n  options.forEach((o) => o.remove());\r\n\r\n  for (let [index, user] of Object.entries(users)) {\r\n    multiselect.options[multiselect.options.length] = new Option(\r\n      user.name,\r\n      index,\r\n      false\r\n    );\r\n  }\r\n}\r\nfunction removeGroupUser(groupIndex, userIndex) {\r\n  if (groups[groupIndex].users[userIndex] !== 0) {\r\n    alert(\"There are dues outstanding!\\nThe user can't be removed.\");\r\n  } else if (confirm(\"Are you sure?\\nThere is no going back!\")) {\r\n    db.ref(`bill-splitter/groups/${groupIndex}/users/${userIndex}`).remove();\r\n    fetchData(groupIndex);\r\n  }\r\n}\r\nfunction activateTab(el, groupIndex) {\r\n  if (!el.classList.contains(\"active\")) {\r\n    document.getElementById(\"tab--friend\").classList.remove(\"active\");\r\n    document.getElementById(\"tab--activity\").classList.remove(\"active\");\r\n    //document.getElementById(\"tab--chart\").classList.remove(\"active\");\r\n    document.getElementById(\"group-details\").innerHTML = \"\";\r\n\r\n    el.classList.add(\"active\");\r\n    const clickedTab = el.getAttribute(\"id\");\r\n\r\n    if (clickedTab === \"tab--friend\") {\r\n      _renderGroupUsers(groupIndex);\r\n    } else if (clickedTab === \"tab--activity\") {\r\n      _renderGroupActivity(groupIndex);\r\n    } else {\r\n      // _renderGroupChart(groupIndex);\r\n    }\r\n  }\r\n}\r\nfunction _renderGroupUsers(groupIndex) {\r\n  const groupRef = groups[groupIndex];\r\n  let list = `<ul class=\"list-group list-group-flush mt-2\">`;\r\n\r\n  if (groupRef.users && Object.keys(groupRef.users).length !== 0) {\r\n    let userRef;\r\n\r\n    for (let [index, amount] of Object.entries(groupRef.users)) {\r\n      userRef = users[index];\r\n      list += `<li class=\"list-group-item\">\r\n          <div class=\"d-flex justify-content-between align-items-center\">\r\n            <span class=\"d-flex justify-content-start align-items-center\">  \r\n              <img src=\"assets/images/${userRef.avatar}.jpg\" alt=\"${userRef.avatar}\" class=\"custom__group-user-list--image\" />\r\n              <span class=\"ml-1\">${userRef.name}</span>\r\n            </span>\r\n            <div style=\"text-align: right;\">`;\r\n      if (amount < 0) {\r\n        list += `<span class=\"text-danger mr-2\"><small class=\"text-muted\">you owe</small> $${Math.abs(\r\n          amount\r\n        ).toFixed(2)}</span>`;\r\n      } else if (amount > 0) {\r\n        list += `<span class=\"text-success mr-2\"><small class=\"text-muted\">owes you</small> $${amount.toFixed(\r\n          2\r\n        )}</span>`;\r\n      } else {\r\n        list += `<small class=\"text-muted mr-2\">all settled up</small>`;\r\n      }\r\n      if (amount != 0) {\r\n        list += `<button type=\"button\" class=\"btn btn-outline-primary btn-sm\">Settle</button>`;\r\n      } else {\r\n        list += `<button type=\"button\" class=\"btn btn-outline-danger btn-sm\" onclick=\"removeGroupUser('${groupIndex}', '${index}')\">Remove</button>`;\r\n      }\r\n      list += `</div>\r\n        </li>`;\r\n    }\r\n    list += `</ul>`;\r\n  } else {\r\n    list = `<div class=\"alert alert-warning mt-3\" role=\"alert\">No friends yet! Add friends to start recording your expenses.</div>`;\r\n  }\r\n\r\n  document.getElementById(\"group-details\").innerHTML = list;\r\n}\r\nfunction _renderGroupActivity(groupIndex) {\r\n  const activities = groups[groupIndex].activity;\r\n  const container = document.getElementById(\"group-details\");\r\n\r\n  if (!activities || Object.keys(activities).length === 0) {\r\n    container.innerHTML = `<div class=\"alert alert-warning mt-3\" role=\"alert\">No bills added yet! Record your expenses now and split your bills easily.</div>`;\r\n  } else {\r\n    let content = `<ul class=\"list-group list-group-flush mt-2\">`;\r\n    let paidByYou, debtAmount;\r\n\r\n    for (let [index, activity] of Object.entries(activities)) {\r\n      paidByYou = activity.paidby === \"0\";\r\n      if (paidByYou) {\r\n        debtAmount =\r\n          parseFloat(activity.amount) -\r\n          parseFloat(activity.amount) / Object.keys(activity.split).length;\r\n      } else {\r\n        debtAmount =\r\n          parseFloat(activity.amount) / Object.keys(activity.split).length;\r\n      }\r\n      content += `<li class=\"list-group-item\">\r\n          <div class=\"d-flex justify-content-between align-items-center mb-2\"> \r\n            <div class=\"d-flex justify-content-start align-items-baseline\">\r\n              <img \r\n                src=\"assets/icons/${activity.category}.svg\"\r\n                alt=\"${activity.category} icon\"\r\n                class=\"custom__group-category--image\">\r\n              <span class=\"ml-2 h5\">\r\n                ${activity.description}\r\n                <small class=\"text-muted\">(${\r\n                  categories[activity.category]\r\n                })</small>\r\n              </span>\r\n            </div>\r\n            <div class=\"h5 text-${\r\n              paidByYou ? \"success\" : \"danger\"\r\n            }\" style=\"text-align: right;\">\r\n              <small style=\"font-size: small;\">${\r\n                paidByYou ? \"you lent\" : \"you borrowed\"\r\n              }</small>\r\n              $${debtAmount.toFixed(2)}\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex justify-content-between align-items-start\">\r\n            <span class=\"d-flex flex-column align-items-start\">\r\n              <span>Total: $${activity.amount}</span>\r\n              <small class=\"text-muted\">\r\n                (Paid by ${\r\n                  paidByYou ? \"You\" : users[activity.paidby].name\r\n                })</small>\r\n            </span>\r\n            <span class=\"d-flex flex-column align-items-end\">`;\r\n\r\n      for (let [userIndex, user] of Object.entries(activity.split)) {\r\n        if (userIndex !== \"0\") {\r\n          content += `<small>${users[userIndex].name}</small>`;\r\n        }\r\n      }\r\n\r\n      content += `</span>\r\n          </div>\r\n        </li>`;\r\n    }\r\n    container.innerHTML = content;\r\n  }\r\n}\r\n\r\n/**\r\n * Expense events\r\n */\r\nfunction addExpense(groupIndex = null) {\r\n  const containerGroup = document.getElementById(\"expense-group\");\r\n  const containerCategories = document.getElementById(\"expense-category\");\r\n  const containerName = document.getElementById(\"expense-name\");\r\n  const containerAmount = document.getElementById(\"expense-amount\");\r\n  const containerPaidby = document.getElementById(\"expense-paidby\");\r\n  const containerUsers = document.getElementById(\"expense-user-list\");\r\n\r\n  containerGroup.innerHTML = \"\";\r\n  containerGroup.removeAttribute(\"disabled\");\r\n  containerCategories.innerHTML = \"\";\r\n  containerName.value = \"\";\r\n  containerAmount.value = \"\";\r\n  containerPaidby.innerHTML = \"\";\r\n  containerUsers.innerHTML = \"\";\r\n\r\n  let listGroup = \"\";\r\n  let listCategory = \"\";\r\n  let listUsers = `<option value=\"0\">You</option>`;\r\n  let checkUsers = \"\";\r\n\r\n  if (groupIndex) {\r\n    listGroup = `<option value=\"${groupIndex}\" selected>${groups[groupIndex].name}</option>`;\r\n    containerGroup.setAttribute(\"disabled\", \"disabled\");\r\n    for (let [index, user] of Object.entries(groups[groupIndex].users)) {\r\n      listUsers += `<option value=\"${index}\">${users[index].name}</option>`;\r\n      checkUsers += `<div class=\"form-check\">\r\n        <input\r\n          class=\"form-check-input\"\r\n          type=\"checkbox\"\r\n          name=\"expense-users\"\r\n          id=\"${index}\"\r\n          value=\"${index}\"\r\n        />\r\n        <label class=\"form-check-label\" for=\"${index}\">${users[index].name}</label>\r\n      </div>`;\r\n    }\r\n  } else {\r\n    for (let [index, group] of Object.entries(groups)) {\r\n      listGroup += `<option value=\"${index}\">${group.name}</option>`;\r\n    }\r\n    for (let [index, user] of Object.entries(users)) {\r\n      listUsers += `<option value=\"${index}\">${user.name}</option>`;\r\n      checkUsers += `<div class=\"form-check\">\r\n        <input\r\n          class=\"form-check-input\"\r\n          type=\"checkbox\"\r\n          name=\"expense-users\"\r\n          id=\"${index}\"\r\n          value=\"${index}\"\r\n        />\r\n        <label class=\"form-check-label\" for=\"${index}\">${user.name}</label>\r\n      </div>`;\r\n    }\r\n  }\r\n  for (let [index, category] of Object.entries(categories)) {\r\n    listCategory += `<option value=\"${index}\">${category}</option>`;\r\n  }\r\n\r\n  containerGroup.innerHTML = listGroup;\r\n  containerCategories.innerHTML = listCategory;\r\n  containerPaidby.innerHTML = listUsers;\r\n  containerUsers.innerHTML = checkUsers;\r\n  document\r\n    .getElementById(\"expense-form\")\r\n    .setAttribute(\"data-group\", groupIndex ? groupIndex : \"\");\r\n}\r\n\r\n/**\r\n * Event listener bindings\r\n */\r\ndocument.getElementById(\"user-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const userIndex = document\r\n    .getElementById(\"user-form\")\r\n    .getAttribute(\"data-user\");\r\n  const userName = DOMPurify.sanitize(\r\n    document.getElementById(\"username\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const userNumber = DOMPurify.sanitize(\r\n    document.getElementById(\"number\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  let gender;\r\n  for (let radio of document.getElementsByName(\"gender\")) {\r\n    if (radio.checked) {\r\n      gender = radio.value;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (userIndex !== \"\") {\r\n    const user = users[userIndex];\r\n    let userData = {};\r\n    let infoChanged = false;\r\n\r\n    if (userName !== user.name) {\r\n      userData.name = userName;\r\n      infoChanged = true;\r\n    }\r\n    if (userNumber !== user.number) {\r\n      userData.number = userNumber;\r\n      infoChanged = true;\r\n    }\r\n    if (gender !== user.gender) {\r\n      userData.gender = gender;\r\n      userData.avatar = \"avatar-\" + _randomNumber(gender);\r\n      infoChanged = true;\r\n    }\r\n\r\n    if (infoChanged) {\r\n      userData.date = _todayDate();\r\n      db.ref(`bill-splitter/users/${userIndex}`).update(userData);\r\n      fetchData(userIndex);\r\n    }\r\n  } else {\r\n    const key = db.ref().child(\"bill-splitter\").push().key;\r\n    let newUser = {};\r\n\r\n    newUser[`bill-splitter/users/${key}`] = {\r\n      name: userName,\r\n      number: userNumber,\r\n      gender: gender,\r\n      amount: 0,\r\n      avatar: \"avatar-\" + _randomNumber(gender),\r\n      date: _todayDate(),\r\n      settled: true,\r\n    };\r\n    db.ref().update(newUser);\r\n    fetchData();\r\n  }\r\n  $(\"#form--user\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"group-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const groupIndex = document\r\n    .getElementById(\"group-form\")\r\n    .getAttribute(\"data-group\");\r\n  const groupName = DOMPurify.sanitize(\r\n    document.getElementById(\"groupname\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  let groupType;\r\n  for (let radio of document.getElementsByName(\"grouptype\")) {\r\n    if (radio.checked) {\r\n      groupType = radio.value;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (groupIndex !== \"\") {\r\n    const group = groups[groupIndex];\r\n    let groupData = {};\r\n    let infoChanged = false;\r\n\r\n    if (groupName !== group.name) {\r\n      groupData.name = groupName;\r\n      infoChanged = true;\r\n    }\r\n    if (groupType !== group.type) {\r\n      groupData.type = groupType;\r\n      infoChanged = true;\r\n    }\r\n\r\n    if (infoChanged) {\r\n      groupData.date = _todayDate();\r\n      db.ref(`bill-splitter/groups/${groupIndex}`).update(groupData);\r\n      fetchData(groupIndex);\r\n    }\r\n  } else {\r\n    const key = db.ref().child(\"bill-splitter\").push().key;\r\n    let newGroup = {};\r\n\r\n    newGroup[`bill-splitter/groups/${key}`] = {\r\n      name: groupName,\r\n      type: groupType,\r\n      date: _todayDate(),\r\n      settled: true,\r\n    };\r\n    db.ref().update(newGroup);\r\n    fetchData(key);\r\n  }\r\n  $(\"#form--group\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"member-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const groupIndex = document\r\n    .getElementById(\"member-form\")\r\n    .getAttribute(\"data-group\");\r\n  const multiselect = document.getElementById(\"user-multiselect\");\r\n  const userOptions = multiselect && multiselect.options;\r\n  let selectedUsers = [];\r\n  let groupMembers = {};\r\n  let userGroupObj;\r\n\r\n  for (let i = 0; i < userOptions.length; i++) {\r\n    if (userOptions[i].selected) {\r\n      selectedUsers.push(userOptions[i].value);\r\n    }\r\n  }\r\n  selectedUsers.forEach((user) => {\r\n    userGroupObj = {};\r\n    if (!groups[groupIndex].users || !groups[groupIndex].users[user]) {\r\n      groupMembers[user] = 0;\r\n    }\r\n    userGroupObj[groupIndex] = true;\r\n    db.ref(`bill-splitter/users/${user}/groups`).update(userGroupObj);\r\n    db.ref(`bill-splitter/users/${user}`).update({\r\n      date: _todayDate(),\r\n    });\r\n  });\r\n\r\n  db.ref(`bill-splitter/groups/${groupIndex}/users`).update(groupMembers);\r\n  db.ref(`bill-splitter/groups/${groupIndex}`).update({\r\n    date: _todayDate(),\r\n  });\r\n\r\n  fetchData(groupIndex);\r\n  $(\"#form--member\").modal(\"toggle\");\r\n});\r\ndocument.getElementById(\"expense-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n\r\n  const groupIndex = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-group\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const categoryName = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-category\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const description = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-name\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const amount = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-amount\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n  const paidbyName = DOMPurify.sanitize(\r\n    document.getElementById(\"expense-paidby\").value,\r\n    INPUT_ALLOWED_TAGS\r\n  );\r\n\r\n  let selectedUsers = {};\r\n  let perPersonAmount;\r\n\r\n  for (const checkbox of document.getElementsByName(\"expense-users\")) {\r\n    if (checkbox.checked) {\r\n      selectedUsers[checkbox.value] = true;\r\n    }\r\n  }\r\n  selectedUsers[paidbyName] = true;\r\n  if (paidbyName !== \"0\") {\r\n    selectedUsers[\"0\"] = true;\r\n  }\r\n\r\n  perPersonAmount = parseFloat(amount) / Object.keys(selectedUsers).length;\r\n\r\n  const key = db.ref().child(\"bill-splitter\").push().key;\r\n  let newActivity = {};\r\n\r\n  newActivity[`bill-splitter/groups/${groupIndex}/activity/${key}`] = {\r\n    category: categoryName,\r\n    description: description,\r\n    amount: amount,\r\n    paidby: paidbyName,\r\n    split: selectedUsers,\r\n    date: _todayDate(),\r\n  };\r\n\r\n  db.ref().update(newActivity);\r\n  db.ref(`bill-splitter/groups/${groupIndex}`).update({\r\n    date: _todayDate(),\r\n    settled: false,\r\n  });\r\n\r\n  let groupUsersUpdate = {};\r\n  let debt, updatedUserAmount, groupUserObj;\r\n\r\n  if (paidbyName === \"0\") {\r\n    for (let [userIndex, selectedUser] of Object.entries(selectedUsers)) {\r\n      if (userIndex !== \"0\") {\r\n        groupUserObj = groups[groupIndex].users[userIndex];\r\n        debt = groupUserObj ? groupUserObj + perPersonAmount : perPersonAmount;\r\n\r\n        groupUsersUpdate[userIndex] = debt;\r\n        updatedUserAmount = users[userIndex].amount + debt;\r\n\r\n        db.ref(`bill-splitter/users/${userIndex}`).update({\r\n          amount: updatedUserAmount,\r\n          settled: false,\r\n        });\r\n      }\r\n    }\r\n  } else {\r\n    groupUserObj = groups[groupIndex].users[paidbyName];\r\n    debt = groupUserObj ? groupUserObj - perPersonAmount : 0 - perPersonAmount;\r\n\r\n    groupUsersUpdate[paidbyName] = debt;\r\n    updatedUserAmount = users[paidbyName].amount - perPersonAmount;\r\n\r\n    db.ref(`bill-splitter/users/${paidbyName}`).update({\r\n      amount: updatedUserAmount,\r\n      settled: false,\r\n    });\r\n  }\r\n\r\n  db.ref(`bill-splitter/groups/${groupIndex}/users`).update(groupUsersUpdate);\r\n  fetchData(groupIndex);\r\n  $(\"#form--expense\").modal(\"toggle\");\r\n});\r\n"],"file":"app.js"}